(()=>{var e={100:(e,t,s)=>{const r=s(681),a=async e=>new Promise(((t,s)=>{const a=r.request(e,(e=>{const s=[];let r=!1;e.on("data",(e=>{if(!r&&!String(e).startsWith("/*O_o*/"))return t(null);r=!0,s.push(e)})),e.on("end",(()=>{t({ok:!0,text:()=>Buffer.concat(s).toString()})}))}));a.on("error",s),a.end()}));e.exports=a,e.exports.default=a},908:(e,t,s)=>{const r="undefined"!=typeof window&&void 0!==window.document?window.fetch:s(100);class a{constructor(e,t){this.id=e,this.setOption(t)}setOption(e){e?"string"==typeof e?(this.sheetName=e,this.sheetId=this.sheetId||null):"object"==typeof e&&(this.sheetName=e.sheetName||this.sheetName,this.sheetId=e.sheetId||this.sheetId,this.useFormattedDate=e.hasOwnProperty("useFormattedDate")?e.useFormattedDate:this.useFormattedDate,this.useFormat=e.hasOwnProperty("useFormat")?e.useFormat:this.useFormat):(this.sheetName=this.sheetName||null,this.sheetId=this.sheetId||null,this.useFormattedDate=this.useFormattedDate||!1,this.useFormat=this.useFormat||!1)}isDate(e){return e&&"string"==typeof e&&/Date\((\d+),(\d+),(\d+)\)/.test(e)}async getSpreadsheetDataUsingFetch(){if(!this.id)return null;let e=`https://docs.google.com/spreadsheets/d/${this.id}/gviz/tq?`;e+=this.sheetId?`gid=${this.sheetId}`:`sheet=${this.sheetName}`;try{const t=await r(e);return t&&t.ok?t.text():null}catch(e){return console.error("Error fetching spreadsheet data:",e),null}}normalizeRow(e){return e.map((e=>e&&null!==e.v&&void 0!==e.v?e:{}))}applyHeaderIntoRows(e,t){return t.map((({c:e})=>this.normalizeRow(e))).map((t=>t.reduce(((t,s,r)=>null!==s.v&&void 0!==s.v?Object.assign(t,{[e[r]]:this.useFormat?s.f||s.v:this.useFormattedDate&&this.isDate(s.v)&&s.f||s.v}):t),{})))}getItems(e){let t=[];try{const s=/google\.visualization\.Query\.setResponse\(({.*})\);/,[r,a]=e.match(s),o=JSON.parse(a);if(o.table.cols.some((({label:e})=>!!e))){const e=o.table.cols.map((({label:e})=>e));t=this.applyHeaderIntoRows(e,o.table.rows)}else{const[e,...s]=o.table.rows,r=this.normalizeRow(e.c).map((e=>e.v));t=this.applyHeaderIntoRows(r,s)}}catch(e){console.error("Error parsing spreadsheet data:",e)}return t}async parse(e,t){if(e&&(this.id=e),t&&this.setOption(t),!this.id)throw new Error("SpreadsheetId is required.");const s=await this.getSpreadsheetDataUsingFetch();return null===s?[]:this.getItems(s)}}e.exports=a,e.exports.default=a},681:()=>{}},t={};function s(r){var a=t[r];if(void 0!==a)return a.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,s),o.exports}(()=>{"use strict";s(908),(async()=>{const{settings:e}=await chrome.storage.sync.get("settings");if(!e.googleSpreadSheetId)return;var t;e.hidePrices&&("*",t=/\$([\d]+\.?\d*)/g,[...document.querySelectorAll("*")].filter((e=>e.childNodes?.[0]?.nodeValue?.match(t)))).forEach((e=>{e.innerHTML=e.innerHTML.replace(/\$([\d]+\.?\d*)/g,"$â€”")}));const s=document.querySelector("div#navbar-buttons"),r=document.createElement("a");r.classList.add("navbar-button"),r.setAttribute("href","https://docs.google.com/spreadsheets/d/"+e.googleSpreadSheetId),r.setAttribute("title","Navigate to spreadsheet"),r.setAttribute("target","_blank"),r.innerHTML='<span aria-hidden="true" class="fa-solid fa-file-csv"></span>',s.prepend(r)})()})()})();