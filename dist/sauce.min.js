(()=>{var e,t,a,s,r={100:(e,t,a)=>{const s=a(681),r=async e=>new Promise(((t,a)=>{const r=s.request(e,(e=>{const a=[];let s=!1;e.on("data",(e=>{if(!s&&!String(e).startsWith("/*O_o*/"))return t(null);s=!0,a.push(e)})),e.on("end",(()=>{t({ok:!0,text:()=>Buffer.concat(a).toString()})}))}));r.on("error",a),r.end()}));e.exports=r,e.exports.default=r},908:(e,t,a)=>{const s="undefined"!=typeof window&&void 0!==window.document?window.fetch:a(100);class r{constructor(e,t){this.id=e,this.setOption(t)}setOption(e){e?"string"==typeof e?(this.sheetName=e,this.sheetId=this.sheetId||null):"object"==typeof e&&(this.sheetName=e.sheetName||this.sheetName,this.sheetId=e.sheetId||this.sheetId,this.useFormattedDate=e.hasOwnProperty("useFormattedDate")?e.useFormattedDate:this.useFormattedDate,this.useFormat=e.hasOwnProperty("useFormat")?e.useFormat:this.useFormat):(this.sheetName=this.sheetName||null,this.sheetId=this.sheetId||null,this.useFormattedDate=this.useFormattedDate||!1,this.useFormat=this.useFormat||!1)}isDate(e){return e&&"string"==typeof e&&/Date\((\d+),(\d+),(\d+)\)/.test(e)}async getSpreadsheetDataUsingFetch(){if(!this.id)return null;let e=`https://docs.google.com/spreadsheets/d/${this.id}/gviz/tq?`;e+=this.sheetId?`gid=${this.sheetId}`:`sheet=${this.sheetName}`;try{const t=await s(e);return t&&t.ok?t.text():null}catch(e){return console.error("Error fetching spreadsheet data:",e),null}}normalizeRow(e){return e.map((e=>e&&null!==e.v&&void 0!==e.v?e:{}))}applyHeaderIntoRows(e,t){return t.map((({c:e})=>this.normalizeRow(e))).map((t=>t.reduce(((t,a,s)=>null!==a.v&&void 0!==a.v?Object.assign(t,{[e[s]]:this.useFormat?a.f||a.v:this.useFormattedDate&&this.isDate(a.v)&&a.f||a.v}):t),{})))}getItems(e){let t=[];try{const a=/google\.visualization\.Query\.setResponse\(({.*})\);/,[s,r]=e.match(a),n=JSON.parse(r);if(n.table.cols.some((({label:e})=>!!e))){const e=n.table.cols.map((({label:e})=>e));t=this.applyHeaderIntoRows(e,n.table.rows)}else{const[e,...a]=n.table.rows,s=this.normalizeRow(e.c).map((e=>e.v));t=this.applyHeaderIntoRows(s,a)}}catch(e){console.error("Error parsing spreadsheet data:",e)}return t}async parse(e,t){if(e&&(this.id=e),t&&this.setOption(t),!this.id)throw new Error("SpreadsheetId is required.");const a=await this.getSpreadsheetDataUsingFetch();return null===a?[]:this.getItems(a)}}e.exports=r,e.exports.default=r},924:(e,t,a)=>{"use strict";a.d(t,{T:()=>r});var s=a(103);class r{constructor(e,t){this.settings=e,this.currentRegion=t}getId=()=>"collection-history-feature";needsToBeAppliedForLocation=e=>e.pathname.includes("/dashboard");apply=async()=>{const e=new s.V(this.settings.getGoogleSpreadSheetId(),"Collection history"),t=this.currentRegion.filterRows(await e.parse(),!0);if(0===t.length)return;const a=document.querySelector("main#page-content"),r=document.createElement("a");r.setAttribute("href","#modal"),r.classList.add("button","button","button-primary"),r.style.minWidth="auto",r.style.marginLeft="3px",r.innerHTML='<span class="fa-solid fa-chart-line"></span>',document.querySelector("div#tcg-region-button-group-container").appendChild(r);const n=document.createElement("section");n.classList.add("modal-window"),n.id="modal",n.innerHTML='<a class="modal-overlay" aria-hidden="true" href="#" tabindex="-1"></a>\n                          <div class="modal-content">\n                            <a title="Close modal" aria-label="Close modal" href="#" class="modal-close">&times; </a>\n                            <h2 id="modal-title">Collection history</h2>\n                            <div class="chart"></div>\n                          </div>',a.appendChild(n);const i=echarts.init(n.querySelector(".modal-content .chart"));t.sort((function(e,t){const a=new Date(e.date),s=new Date(t.date);return a<s?-1:a>s?1:0}));const o=t[t.length-1],c={animation:!1,tooltip:{trigger:"axis",valueFormatter:e=>e,backgroundColor:"#181A1B",axisPointer:{label:{formatter:function(e){return new Date(e.value).toLocaleDateString()}}}},legend:{textStyle:{color:"#d8d4cf"}},xAxis:{type:"time",axisLabel:{formatter:{year:"{yyyy}",month:"{MMM}",day:"{d} {MMM}",hour:"",minute:"",second:"",millisecond:"",none:""},color:"#d8d4cf"}},yAxis:[{axisLabel:{formatter:function(e,t){return e},color:"#d8d4cf"},splitLine:{show:!1}}],series:[{name:`Unique cards (${o.uniqueCards})`,type:"line",data:t.map((e=>[e.date,e.uniqueCards]))},{name:`Unique variants (${o.uniqueVariants})`,type:"line",data:t.map((e=>[e.date,e.uniqueVariants]))},{name:`Total cards (${o.totalCards})`,type:"line",data:t.map((e=>[e.date,e.totalCards]))},{name:`Total value ($${o.totalValue})`,type:"line",tooltip:{valueFormatter:e=>"$"+e},data:t.map((e=>[e.date,e.totalValue]))}]};i.setOption(c)}}},991:(e,t,a)=>{"use strict";a.d(t,{c:()=>s});class s{constructor(){}getId=()=>"dashboard-rearrangement-feature";needsToBeAppliedForLocation=e=>e.pathname.includes("/dashboard");apply=async()=>{const[e,t]=document.querySelectorAll("div.dashboard-sections-region");e.querySelector("div#dashboard-expansions-completed-section").style.display="none",t.style.display="none",e.appendChild(t.querySelectorAll("div.dashboard-sections-subregion")[1].querySelector("div.dashboard-section"))}}},156:(e,t,a)=>{"use strict";a.d(t,{B:()=>r});var s=a(840);class r{constructor(e){this.settings=e}getId=()=>"hide-prices-feature";needsToBeAppliedForLocation=e=>this.settings.hidePrices();apply=()=>{(0,s.gR)("*",/\$([\d]+\.?\d*)/g).forEach((e=>{e.innerHTML=e.innerHTML.replace(/\$([\d]+\.?\d*)/g,"$â€”")}))}}},822:(e,t,a)=>{"use strict";a.d(t,{B:()=>s});class s{constructor(e){this.settings=e}getId=()=>"new-menu-item-feature";needsToBeAppliedForLocation=e=>document.querySelectorAll("div#navbar-buttons").length>0;apply=()=>{const e=document.querySelector("div#navbar-buttons"),t=document.createElement("a");t.classList.add("navbar-button"),t.setAttribute("href","https://docs.google.com/spreadsheets/d/"+this.settings.getGoogleSpreadSheetId()),t.setAttribute("title","Navigate to spreadsheet"),t.setAttribute("target","_blank"),t.innerHTML='<span aria-hidden="true" class="fa-solid fa-file-csv"></span>',e.prepend(t)}}},607:(e,t,a)=>{"use strict";a.d(t,{O:()=>s});class s{constructor(){}getId=()=>"print-binder-placeholders-feature";needsToBeAppliedForLocation=e=>"/cards"===e.pathname||"/cards/intl"===e.pathname||"/cards/jp"===e.pathname||e.pathname.includes("/cards/jp/")||e.pathname.includes("/cards/intl/");apply=()=>{const e=document.body.innerHTML,t=/window.tcgcollector[\s]*=[\s]*{[\s]*appState:(.*),[\s]*}/im;if(!t.test(e))throw new Error("AppState could not be determined");const a=JSON.parse(e.match(t)[1]),s=a.cardIdToCardVariantTypeIdsMap,r=a.idToCardVariantTypeDtoMap,n=document.querySelectorAll("div#card-image-grid div.card-image-grid-item"),i=document.createElement("div");return i.setAttribute("id","print"),n.forEach((e=>{const t=e.getAttribute("data-card-id"),a=e.querySelector("a").getAttribute("title").split("(")[0].trim(),n=e.querySelector("span.card-image-grid-item-info-overlay-text-part").innerText.trim();s[t].forEach((e=>{const t=r[e].name,s=document.createElement("div");s.classList.add("placeholder"),s.innerHTML=`<div>${a}</div><div>${n}</div><div>${t}</div>`,i.appendChild(s)}))})),document.body.appendChild(i)}}},143:(e,t,a)=>{"use strict";a.d(t,{P:()=>n});var s=a(103);class r{constructor(e){if(!e)throw new Error("Grading company name cannot be empty");this.name=e}getName=()=>this.name.toLowerCase();getLabel=()=>this.name;getGetCertUrl=e=>{if("psa"===this.getName())return`https://www.psacard.com/cert/${e}`;if("cgc"===this.getName())return`https://www.cgccards.com/certlookup/${e}`;throw new Error(`Unknown grading company ${this.name}`)}}class n{constructor(e){this.settings=e}getId=()=>"purchase-price-feature";needsToBeAppliedForLocation=e=>/cards\/[\d]+\/[\S]+/im.test(e.pathname);apply=async()=>{const e=document.querySelector("[data-card-id]").getAttribute("data-card-id"),t=document.createElement("div");t.classList.add("tcg-collector-card-prices-wrapper");const a=document.createElement("div");a.classList.add("tcg-collector-card-prices");const n=new s.V(this.settings.getGoogleSpreadSheetId(),"Slabs / Singles"),i=(await n.parse()).filter((t=>t.cardId===e));if(0===i.length)return t;i.forEach((function(e){const t=document.createElement("div");t.innerHTML=`<div>${e.purchaseDate}</div><div>${e.price}</div>`;try{const a=new r(e.gradingCompany);e.certNumber?t.innerHTML+=`\n<div class="grading">\n    <span>${e.type}</span>\n    <a href="${a.getGetCertUrl(e.certNumber)}" target="_blank" title="${a.getLabel()}" class="icon ${a.getName()}">\n        ${a.getLabel()}\n    </a>\n</div>`:t.innerHTML+=`\n<div class="grading">\n    <span>${e.type}</span>\n    <span title="${a.getLabel()}" class="icon ${a.getName()}">\n        ${a.getLabel()}\n    </span>\n</div>`}catch(a){t.innerHTML+=`<div>${e.type}</div>`}a.appendChild(t)}));const o=document.createElement("div");o.innerHTML="Purchase price(s)",o.classList.add("title"),t.appendChild(o),t.appendChild(a),document.querySelector("div#card-page-inner-content div.card-image-controls").appendChild(t)}}},976:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});var s=a(103);class r{constructor(e,t){this.settings=e,this.currentRegion=t}getId=()=>"quick-access-links-feature";needsToBeAppliedForLocation=e=>e.pathname.includes("/dashboard");apply=async()=>{const e=document.querySelectorAll("div.dashboard-section div.list-group")[1];e.innerHTML='<div class="loading-state-loading-spinner-underlay" style="display: flex; justify-content: center"><div class="loading-state-loading-spinner loading-spinner"></div></div>';const t=new s.V(this.settings.getGoogleSpreadSheetId(),"Slabs / Singles"),a=`/cards?releaseDateOrder=newToOld&cardsPerPage=120&displayAs=images&sortBy=cardNameAsc&cards=${this.currentRegion.filterRows(await t.parse()).filter((e=>"Single"===e.type)).map((e=>parseInt(e.cardId))).join(",")}`,r=new s.V(this.settings.getGoogleSpreadSheetId(),"Quick access links"),n=(await r.parse()).filter((e=>"TRUE"===e[this.currentRegion.name]));n.push({title:"Singles",url:a,icon:"fa-database"}),e.innerHTML="",n.forEach((t=>{const a=document.createElement("a");a.classList.add("list-group-item"),a.setAttribute("href",this.currentRegion.buildUri(t.url)),a.innerHTML=`\n        <span class="list-group-item-left-item-container">\n          <span aria-hidden="true" class="list-group-item-side-item-icon fa-solid ${t.icon} fa-fw"></span>\n        </span>\n        ${t.title}\n        <span class="list-group-item-right-item-container">\n          <span aria-hidden="true" class="list-group-item-side-item-icon fa-solid fa-chevron-right"></span>\n        </span>`,e.appendChild(a)}))}}},318:(e,t,a)=>{"use strict";a.d(t,{l:()=>r});class s{constructor(e){this.settings=e,"cardMarket"===this.settings.getMarketPlaceLinks()?this.iconUrl=chrome.runtime.getURL("dist/assets/card-market.jpg"):this.iconUrl=chrome.runtime.getURL("dist/assets/ebay.png")}buildFor=(e,t)=>{const a=document.createElement("a"),s=e.querySelector("a").getAttribute("title").split("(")[0].trim();if("cardMarket"===this.settings.getMarketPlaceLinks()){const r=parseInt(e.querySelector("span.card-image-grid-item-info-overlay-text-part").innerText.split("/")[0].replace(/\D/g,"").trim());return a.classList.add("market-place-link"),a.setAttribute("href",`https://www.cardmarket.com/en/Pokemon/Products/Search?searchString=${s}+${r}+${t}`),a.setAttribute("title","Find this card on cardmarket.com"),a.setAttribute("target","_blank"),a.innerHTML=`<img src="${this.iconUrl}" alt="Card market" />`,a}const r=e.querySelector("span.card-image-grid-item-info-overlay-text-part").innerText.trim(),n={_from:"R40"};return this.settings.getEbayListingType()&&(n["LH_"+this.settings.getEbayListingType()]=1),this.settings.getEbaySortBy()&&(n._sop=this.settings.getEbaySortBy()),a.classList.add("market-place-link"),a.setAttribute("href",`${this.settings.getEbayUrl().replace(/\/$/,"")}/sch/i.html?_nkw=${s}+${r}&${new URLSearchParams(n).toString()}`),a.setAttribute("title",`Find this card on ${this.settings.getEbayUrl()}`),a.setAttribute("target","_blank"),a.innerHTML=`<img src="${this.iconUrl}" alt="Ebay" />`,a}}class r{constructor(e){this.settings=e}getId=()=>"market-place-links-feature";needsToBeAppliedForLocation=e=>!!this.settings.getMarketPlaceLinks()&&"none"!==this.settings.getMarketPlaceLinks()&&("/cards"===e.pathname||"/cards/intl"===e.pathname||"/cards/jp"===e.pathname||e.pathname.includes("/cards/jp/")||e.pathname.includes("/cards/intl/"));apply=()=>{const e=document.querySelectorAll("div#card-image-grid div.card-image-grid-item"),t=document.querySelector("span#card-search-result-title-expansion-code")?.innerText||"",a=new s(this.settings);e.forEach((e=>{e.querySelector("div.card-image-controls-item").appendChild(a.buildFor(e,t))}))}}},103:(e,t,a)=>{"use strict";a.d(t,{V:()=>i});var s=a(908),r=a.n(s),n=a(840);class i{constructor(e,t){this.spreadSheetId=e,this.sheetName=t}parse=async()=>{const e=new(r())(this.spreadSheetId,{sheetName:this.sheetName,useFormat:!0});return(await e.parse()).map((e=>{const t={};return Object.keys(e).forEach((a=>{t[(0,n.PT)(a)]=e[a]})),t}))}}},13:(e,t,a)=>{"use strict";a.d(t,{T:()=>s});class s{constructor(e){this.name=e}isAll(){return"all"===this.name}filterRows(e,t=!1){return this.isAll()&&!t?e:e.filter((e=>e.region===this.name))}buildUri(e){return this.isAll()?e.replace("[REGION]",""):e.replace("[REGION]","/"+this.name)}static fromCurrentUrl(){const e=window.location.href.replace("#","");return 4===e.split("/").length?new s("all"):new s(e.split("/").slice(-1)[0])}}},496:(e,t,a)=>{"use strict";a.d(t,{wB:()=>n});const s="cardMarketCardLanguages",r="cardMarketSellerLocations";class n{constructor(e){this.storage=e}getGoogleSpreadSheetId=()=>this.storage.googleSpreadSheetId||"";hidePrices=()=>this.storage.hidePrices||!1;getMarketPlaceLinks=()=>this.storage.marketPlaceLinks||"none";getCardMarketCardLanguages=()=>this.storage[s]||[];getCardMarketSellerLocations=()=>this.storage[r]||[];getCardMarketMinCondition=()=>this.storage.cardMarketMinCondition||2;getEbayUrl=()=>this.storage.ebayUrl||"";getEbayListingType=()=>this.storage.ebayListingType||"all";getEbaySortBy=()=>this.storage.ebaySortBy||"best_match";get=e=>this.storage[e];static getSettingsWithMultipleValues=()=>[s,r];static fromSyncStorage=async()=>{let{settings:e}=await chrome.storage.sync.get("settings");return new n(e||{})};static save=async e=>{const t=Object.fromEntries(e.entries());n.getSettingsWithMultipleValues().forEach((a=>{t[a]=e.getAll(a)})),await chrome.storage.sync.set({settings:t})}}},840:(e,t,a)=>{"use strict";a.d(t,{PT:()=>s,_B:()=>n,gR:()=>r});const s=e=>e.replace(/(?:^\w|[A-Z]|\b\w)/g,(function(e,t){return 0===t?e.toLowerCase():e.toUpperCase()})).replace(/\s+/g,""),r=(e,t)=>[...document.querySelectorAll(e)].filter((e=>e.childNodes?.[0]?.nodeValue?.match(t))),n=e=>{console.log(`%c\n   _____                         __             _______ _____ _____    _____      _ _           _               \n  / ____|                       / _|           |__   __/ ____/ ____|  / ____|    | | |         | |              \n | (___   __ _ _   _  ___ ___  | |_ ___  _ __     | | | |   | |  __  | |     ___ | | | ___  ___| |_ ___  _ __   \n  \\___ \\ / _\` | | | |/ __/ _ \\ |  _/ _ \\| '__|    | | | |   | | |_ | | |    / _ \\| | |/ _ \\/ __| __/ _ \\| '__|  \n  ____) | (_| | |_| | (_|  __/ | || (_) | |       | | | |___| |__| | | |___| (_) | | |  __/ (__| || (_) | |     \n |_____/ \\__,_|\\__,_|\\___\\___| |_| \\___/|_|       |_|  \\_____\\_____|  \\_____\\___/|_|_|\\___|\\___|\\__\\___/|_|     \n                                                                                                                \n  ${e.padEnd(110," ")}\n`,"color:#FA7035; background:#222;")}},483:(e,t,a)=>{"use strict";a.a(e,(async(e,t)=>{try{var s=a(496),r=a(822),n=a(156),i=a(924),o=a(13),c=a(991),d=a(976),l=a(143),p=a(607),h=a(840),u=a(318);const e=await s.wB.fromSyncStorage(),g=o.T.fromCurrentUrl(),m=window.location;if(!e.getGoogleSpreadSheetId())throw new Error("Google Spreadsheet ID not configured");document.querySelector("a.navbar-logo-link img").setAttribute("src",chrome.runtime.getURL("dist/assets/tcgc-logo.png"));const _=new r.B(e),y=new n.B(e),f=new i.T(e,g),b=new c.c,w=new d.Z(e,g),v=new l.P(e),S=[_,y,f,b,w,v,new p.O,new u.l(e)];(0,h._B)("Applying that sweet sauce ðŸ¥«");const L=document.body;for(const e of S)e.needsToBeAppliedForLocation(m)&&(L.classList.add(e.getId()),e.apply());window.addEventListener("keydown",(e=>{"Escape"===e.key&&"#modal"===window.location.hash&&(window.location.hash="")})),t()}catch(e){t(e)}}),1)},681:()=>{}},n={};function i(e){var t=n[e];if(void 0!==t)return t.exports;var a=n[e]={exports:{}};return r[e](a,a.exports,i),a.exports}e="function"==typeof Symbol?Symbol("webpack queues"):"__webpack_queues__",t="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",a="function"==typeof Symbol?Symbol("webpack error"):"__webpack_error__",s=e=>{e&&e.d<1&&(e.d=1,e.forEach((e=>e.r--)),e.forEach((e=>e.r--?e.r++:e())))},i.a=(r,n,i)=>{var o;i&&((o=[]).d=-1);var c,d,l,p=new Set,h=r.exports,u=new Promise(((e,t)=>{l=t,d=e}));u[t]=h,u[e]=e=>(o&&e(o),p.forEach(e),u.catch((e=>{}))),r.exports=u,n((r=>{var n;c=(r=>r.map((r=>{if(null!==r&&"object"==typeof r){if(r[e])return r;if(r.then){var n=[];n.d=0,r.then((e=>{i[t]=e,s(n)}),(e=>{i[a]=e,s(n)}));var i={};return i[e]=e=>e(n),i}}var o={};return o[e]=e=>{},o[t]=r,o})))(r);var i=()=>c.map((e=>{if(e[a])throw e[a];return e[t]})),d=new Promise((t=>{(n=()=>t(i)).r=0;var a=e=>e!==o&&!p.has(e)&&(p.add(e),e&&!e.d&&(n.r++,e.push(n)));c.map((t=>t[e](a)))}));return n.r?d:i()}),(e=>(e?l(u[a]=e):d(h),s(o)))),o&&o.d<0&&(o.d=0)},i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var a in t)i.o(t,a)&&!i.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i(483)})();