
/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/public-google-sheets-parser@1.5.0/dist/index.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
function asyncGeneratorStep(e,t,s,r,o,a,n){try{var i=e[a](n),h=i.value}catch(e){return void s(e)}i.done?t(h):Promise.resolve(h).then(r,o)}function _asyncToGenerator(e){return function(){var t=this,s=arguments;return new Promise((function(r,o){var a=e.apply(t,s);function n(e){asyncGeneratorStep(a,r,o,n,i,"next",e)}function i(e){asyncGeneratorStep(a,r,o,n,i,"throw",e)}n(void 0)}))}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var s=0;s<t.length;s++){var r=t[s];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,s){return t&&_defineProperties(e.prototype,t),s&&_defineProperties(e,s),e}const isBrowser="undefined"==typeof require,fetch=isBrowser?window.fetch:require("../src/fetch");let PublicGoogleSheetsParser=function(){function e(t,s){_classCallCheck(this,e),this.id=t,this.setOption(s)}var t,s;return _createClass(e,[{key:"setOption",value:function(e){e?"string"==typeof e?(this.sheetName=e,this.sheetId=this.sheetId||null):"object"==typeof e&&(this.sheetName=e.sheetName||this.sheetName,this.sheetId=e.sheetId||this.sheetId,this.useFormattedDate=e.hasOwnProperty("useFormattedDate")?e.useFormattedDate:this.useFormattedDate,this.useFormat=e.hasOwnProperty("useFormat")?e.useFormat:this.useFormat):(this.sheetName=this.sheetName||null,this.sheetId=this.sheetId||null,this.useFormattedDate=this.useFormattedDate||!1,this.useFormat=this.useFormat||!1)}},{key:"isDate",value:function(e){return e&&"string"==typeof e&&/Date\((\d+),(\d+),(\d+)\)/.test(e)}},{key:"getSpreadsheetDataUsingFetch",value:(s=_asyncToGenerator((function*(){if(!this.id)return null;let e=`https://docs.google.com/spreadsheets/d/${this.id}/gviz/tq?`;e+=this.sheetId?`gid=${this.sheetId}`:`sheet=${this.sheetName}`;try{const t=yield fetch(e);return t&&t.ok?t.text():null}catch(e){return console.error("Error fetching spreadsheet data:",e),null}})),function(){return s.apply(this,arguments)})},{key:"normalizeRow",value:function(e){return e.map((e=>e&&null!==e.v&&void 0!==e.v?e:{}))}},{key:"applyHeaderIntoRows",value:function(e,t){return t.map((({c:e})=>this.normalizeRow(e))).map((t=>t.reduce(((t,s,r)=>null!==s.v&&void 0!==s.v?Object.assign(t,{[e[r]]:this.useFormat?s.f||s.v:this.useFormattedDate&&this.isDate(s.v)&&s.f||s.v}):t),{})))}},{key:"getItems",value:function(e){let t=[];try{const s=JSON.parse(e.split("\n")[1].replace(/google.visualization.Query.setResponse\(|\);/g,""));if(s.table.cols.some((({label:e})=>!!e))){const e=s.table.cols.map((({label:e})=>e));t=this.applyHeaderIntoRows(e,s.table.rows)}else{const[e,...r]=s.table.rows,o=this.normalizeRow(e.c).map((e=>e.v));t=this.applyHeaderIntoRows(o,r)}}catch(e){console.error("Error parsing spreadsheet data:",e)}return t}},{key:"parse",value:(t=_asyncToGenerator((function*(e,t){if(e&&(this.id=e),t&&this.setOption(t),!this.id)throw new Error("SpreadsheetId is required.");const s=yield this.getSpreadsheetDataUsingFetch();return null===s?[]:this.getItems(s)})),function(e,s){return t.apply(this,arguments)})}]),e}();isBrowser?window.PublicGoogleSheetsParser=PublicGoogleSheetsParser:(module.exports=PublicGoogleSheetsParser,module.exports.default=PublicGoogleSheetsParser);
//# sourceMappingURL=/sm/7933761f7e1340163b64207ee088206ad04cb4cd026626011dc9a7d99e59ddd7.map